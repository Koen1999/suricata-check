suricata-check 0.0.1

2025-11-08 15:53:24,584 - suricata_check.suricata_check - INFO - Running suricata-check with the following arguments:[0m
2025-11-08 15:53:24,600 - suricata_check.suricata_check - INFO - rules: tests\data\test.rules[0m
2025-11-08 15:53:24,600 - suricata_check.suricata_check - INFO - single_rule: None[0m
2025-11-08 15:53:24,601 - suricata_check.suricata_check - INFO - out: .[0m
2025-11-08 15:53:24,601 - suricata_check.suricata_check - INFO - log_level: DEBUG[0m
2025-11-08 15:53:24,602 - suricata_check.suricata_check - INFO - gitlab: False[0m
2025-11-08 15:53:24,602 - suricata_check.suricata_check - INFO - github: False[0m
2025-11-08 15:53:24,605 - suricata_check.suricata_check - INFO - evaluate_disabled: False[0m
2025-11-08 15:53:24,606 - suricata_check.suricata_check - INFO - issue_severity: INFO[0m
2025-11-08 15:53:24,606 - suricata_check.suricata_check - INFO - include_all: False[0m
2025-11-08 15:53:24,606 - suricata_check.suricata_check - INFO - include: ()[0m
2025-11-08 15:53:24,607 - suricata_check.suricata_check - INFO - exclude: ()[0m
[2m2025-11-08 15:53:24,607 - suricata_check.suricata_check - DEBUG - Platform: win32[0m
[2m2025-11-08 15:53:24,607 - suricata_check.suricata_check - DEBUG - Python version: 3.13.9 (tags/v3.13.9:8183fa5, Oct 14 2025, 14:09:13) [MSC v.1944 64 bit (AMD64)][0m
[2m2025-11-08 15:53:24,608 - suricata_check.suricata_check - DEBUG - suricata-check path: C:\Users\lenovo\suricata-check[0m
[2m2025-11-08 15:53:24,608 - suricata_check.suricata_check - DEBUG - suricata-check version: 0.0.1[0m
[2m2025-11-08 15:53:24,610 - suricata_check._version - DEBUG - Detected suricata-check requirements using requirements.txt[0m
[2m2025-11-08 15:53:24,755 - suricata_check._version - DEBUG - Detected suricata-check version using setuptools_git_versioning: 0.0.1[0m
2025-11-08 15:53:24,790 - suricata_check._checkers - INFO - Discovered and enabled checkers: [BestChecker, UnexpectedChecker, MandatoryChecker, MetadataChecker, MsgChecker, OrderChecker, OverallChecker, PcreChecker, PerformanceChecker, ReferenceChecker, SidChecker, StateChecker, WhitespaceChecker][0m
2025-11-08 15:53:24,791 - suricata_check.utils._path - INFO - Found Suricata rules file: tests\data\test.rules[0m
2025-11-08 15:53:24,792 - suricata_check.suricata_check - INFO - Processing rule file: tests\data\test.rules[0m
[2m2025-11-08 15:53:24,792 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,793 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,793 - suricata_check.suricata_check - DEBUG - Processing rule: 1 on line 7[0m
[33m[1m2025-11-08 15:53:24,794 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,794 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1[0m
[2m2025-11-08 15:53:24,794 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,795 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,795 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,795 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1[0m
[2m2025-11-08 15:53:24,796 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1[0m
[2m2025-11-08 15:53:24,796 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,796 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,796 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,797 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,797 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,797 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1[0m
[2m2025-11-08 15:53:24,797 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,798 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,798 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,798 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,799 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,799 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1[0m
[2m2025-11-08 15:53:24,799 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,800 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,800 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,800 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,801 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,801 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,801 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,802 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,803 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1[0m
[2m2025-11-08 15:53:24,803 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1[0m
[2m2025-11-08 15:53:24,804 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1[0m
[2m2025-11-08 15:53:24,804 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,805 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1[0m
[2m2025-11-08 15:53:24,805 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1[0m
[2m2025-11-08 15:53:24,805 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: T[0m
[2m2025-11-08 15:53:24,805 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1[0m
[2m2025-11-08 15:53:24,806 - suricata_check.utils.checker - DEBUG - Option flow not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,806 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,806 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,807 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,807 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,807 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,807 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,808 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,808 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,808 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1[0m
[2m2025-11-08 15:53:24,809 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,809 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,809 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1[0m
[2m2025-11-08 15:53:24,810 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,811 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,811 - suricata_check.suricata_check - DEBUG - Processing rule: 1 on line 8[0m
[33m[1m2025-11-08 15:53:24,812 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,812 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1[0m
[2m2025-11-08 15:53:24,812 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,813 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,813 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,813 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1[0m
[2m2025-11-08 15:53:24,814 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1[0m
[2m2025-11-08 15:53:24,814 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,814 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,815 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,815 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,815 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,815 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1[0m
[2m2025-11-08 15:53:24,816 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,816 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,816 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,817 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,817 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,817 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1[0m
[2m2025-11-08 15:53:24,818 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,818 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,818 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,819 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,819 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,819 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,820 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,820 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,821 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1[0m
[2m2025-11-08 15:53:24,821 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1[0m
[2m2025-11-08 15:53:24,822 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1[0m
[2m2025-11-08 15:53:24,822 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,823 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1[0m
[2m2025-11-08 15:53:24,823 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1[0m
[2m2025-11-08 15:53:24,823 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: T[0m
[2m2025-11-08 15:53:24,824 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1[0m
[2m2025-11-08 15:53:24,824 - suricata_check.utils.checker - DEBUG - Option flow not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,824 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,824 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,825 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,825 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,825 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,826 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,826 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,826 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,827 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1[0m
[2m2025-11-08 15:53:24,827 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,827 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,827 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1[0m
[2m2025-11-08 15:53:24,828 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,829 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,829 - suricata_check.suricata_check - DEBUG - Processing rule: 1 on line 9[0m
[33m[1m2025-11-08 15:53:24,830 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,831 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1[0m
[2m2025-11-08 15:53:24,831 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,831 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,832 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,832 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1[0m
[2m2025-11-08 15:53:24,832 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1[0m
[2m2025-11-08 15:53:24,833 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,833 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,833 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,833 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,834 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,834 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1[0m
[2m2025-11-08 15:53:24,834 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,834 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,835 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,835 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,835 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,836 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1[0m
[2m2025-11-08 15:53:24,836 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,837 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,837 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,837 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,837 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,838 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,838 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,838 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('content', 'pcre') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,840 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1[0m
[2m2025-11-08 15:53:24,841 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1[0m
[2m2025-11-08 15:53:24,841 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1[0m
[2m2025-11-08 15:53:24,841 - suricata_check.utils.checker - DEBUG - No sequences found separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert ip any any -> any any (msg:"Test"; sid:1;)[0m
[2m2025-11-08 15:53:24,842 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1[0m
[2m2025-11-08 15:53:24,842 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1[0m
[2m2025-11-08 15:53:24,843 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: T[0m
[2m2025-11-08 15:53:24,843 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1[0m
[2m2025-11-08 15:53:24,843 - suricata_check.utils.checker - DEBUG - Option flow not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,844 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,844 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,844 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,845 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,845 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'ip', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'Test', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"Test"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert ip any any -> any any (msg:"Test"; sid:1;)', 'header': 'alert ip any any -> any any'}.[0m
[2m2025-11-08 15:53:24,845 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,846 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,846 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,847 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1[0m
[2m2025-11-08 15:53:24,847 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,847 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,848 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1[0m
[2m2025-11-08 15:53:24,849 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,849 - suricata_check.suricata_check - DEBUG - Processing rule: 1999000 on line 21[0m
[33m[1m2025-11-08 15:53:24,850 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,850 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,851 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,851 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,851 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,852 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,853 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,853 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,853 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,854 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,854 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,855 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,855 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,856 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,856 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,857 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,857 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,858 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,859 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,859 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,860 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,860 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,861 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,863 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,864 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,864 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,865 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,865 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,866 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,866 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:24,866 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:24,867 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,867 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,867 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,868 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999000, 'rev': 1, 'msg': 'KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)', 'flowbits': [], 'metadata': ['affected_product Any', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'set,koen_supports_sni_domain,track ip_dst'}, {'name': 'noalert', 'value': None}, {'name': 'threshold', 'value': 'type both,track by_dst,count 5,seconds 86400'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999000'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses domain name as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_domain,track ip_dst; noalert; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999000; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls any any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"', 'xbits': 'set,koen_supports_sni_domain,track ip_dst', 'noalert': None, 'threshold': 'type both,track by_dst,count 5,seconds 86400'}.[0m
[2m2025-11-08 15:53:24,868 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,869 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,869 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,870 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,870 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,870 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,871 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,871 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,871 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999000[0m
[2m2025-11-08 15:53:24,873 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,873 - suricata_check.suricata_check - DEBUG - Processing rule: 1999001 on line 22[0m
[33m[1m2025-11-08 15:53:24,874 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,874 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,874 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999001, 'rev': 1, 'msg': 'KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)', 'flowbits': [], 'metadata': ['affected_product Any', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'set,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_dst,count 5,seconds 86400'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999001'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls any any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"', 'xbits': 'set,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_dst,count 5,seconds 86400'}.[0m
[2m2025-11-08 15:53:24,875 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,875 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,875 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,876 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,876 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,876 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,877 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,877 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,877 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,878 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,878 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,879 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,879 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,879 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,880 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,881 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,881 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,882 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,882 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,883 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,883 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,884 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,884 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,886 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,886 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,887 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,887 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,887 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,888 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,888 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:24,889 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:24,889 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,889 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,889 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,890 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999001, 'rev': 1, 'msg': 'KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)', 'flowbits': [], 'metadata': ['affected_product Any', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'set,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_dst,count 5,seconds 86400'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999001'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI)"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"; xbits:isnotset,koen_supports_sni,track ip_dst; xbits:set,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_dst,count 5,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999001; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls any any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"', 'xbits': 'set,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_dst,count 5,seconds 86400'}.[0m
[2m2025-11-08 15:53:24,890 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,890 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,891 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,891 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,891 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,892 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,892 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,892 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,893 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,893 - suricata_check.utils.checker - DEBUG - [('isnotset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('set', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,893 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999001[0m
[2m2025-11-08 15:53:24,894 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,895 - suricata_check.suricata_check - DEBUG - Processing rule: 1999002 on line 23[0m
[33m[1m2025-11-08 15:53:24,895 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,896 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,896 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,897 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,897 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,897 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,898 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,898 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,898 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,899 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,899 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,900 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,900 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:24,900 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,901 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,901 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,901 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'bsize'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,902 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'bsize'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,903 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'bsize'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,903 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'bsize'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,903 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'bsize'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,904 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'bsize'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,905 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'bsize'),) separated by ('content', 'pcre') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,906 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,907 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,907 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,908 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'bsize'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:24,908 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,908 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,909 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:24,909 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:24,910 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,910 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,910 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,911 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999002, 'rev': 1, 'msg': 'KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)', 'flowbits': [], 'metadata': ['affected_product Any', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'bsize', 'value': '>0'}, {'name': 'xbits', 'value': 'set,koen_supports_sni,track ip_dst'}, {'name': 'noalert', 'value': None}, {'name': 'threshold', 'value': 'type both,track by_dst,count 15,seconds 86400'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999002'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls any any -> $HTTP_SERVERS 443 (msg:"KOEN INFO HTTPS (HTTP/TLS) Server commonly uses Server Name Indication (SNI)"; flow:established,to_server; tls.sni; bsize:>0; xbits:set,koen_supports_sni,track ip_dst; noalert; threshold:type both,track by_dst,count 15,seconds 86400; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999002; rev:1; metadata:affected_product Any, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls any any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'bsize': '>0', 'xbits': 'set,koen_supports_sni,track ip_dst', 'noalert': None, 'threshold': 'type both,track by_dst,count 15,seconds 86400'}.[0m
[2m2025-11-08 15:53:24,911 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,912 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,912 - suricata_check.utils.checker - DEBUG - [('set', None), ('koen_supports_sni', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,912 - suricata_check.utils.checker - DEBUG - [('set', None), ('koen_supports_sni', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,913 - suricata_check.utils.checker - DEBUG - [('set', None), ('koen_supports_sni', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,913 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,913 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,914 - suricata_check.utils.checker - DEBUG - [('set', None), ('koen_supports_sni', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,914 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999002[0m
[2m2025-11-08 15:53:24,915 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,915 - suricata_check.suricata_check - DEBUG - Processing rule: 1999010 on line 32[0m
[33m[1m2025-11-08 15:53:24,916 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,916 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,917 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999010, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16 03|"'}, {'name': 'depth', 'value': '2'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '1'}, {'name': 'byte_jump', 'value': '1, 37, relative, big'}, {'name': 'byte_jump', 'value': '2, 0, relative, big'}, {'name': 'byte_jump', 'value': '1, 0, relative, big'}, {'name': 'byte_extract', 'value': '2, 0, ext_len, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_domain,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999010'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'content': '!"|00 00|"', 'depth': '2', 'distance': '0', 'within': '2', 'byte_jump': '2, 2, relative, big', 'byte_extract': '2, 0, ext_len, relative, big', 'isdataat': '1, relative', 'xbits': 'isnotset,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:24,917 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,918 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,918 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,918 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,919 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,919 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,919 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,920 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,920 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,921 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,921 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,921 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,922 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,922 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,923 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,924 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,924 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,926 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,927 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,927 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,928 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,929 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,930 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,933 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,933 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,934 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,935 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth', 'content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,935 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,935 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,936 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:24,936 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:24,937 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,937 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,937 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,938 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999010, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16 03|"'}, {'name': 'depth', 'value': '2'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '1'}, {'name': 'byte_jump', 'value': '1, 37, relative, big'}, {'name': 'byte_jump', 'value': '2, 0, relative, big'}, {'name': 'byte_jump', 'value': '1, 0, relative, big'}, {'name': 'byte_extract', 'value': '2, 0, ext_len, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_domain,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999010'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while domain name was expected"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999010; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'content': '!"|00 00|"', 'depth': '2', 'distance': '0', 'within': '2', 'byte_jump': '2, 2, relative, big', 'byte_extract': '2, 0, ext_len, relative, big', 'isdataat': '1, relative', 'xbits': 'isnotset,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:24,938 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,938 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,939 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,939 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,939 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,940 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,940 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,941 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,941 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999010[0m
[2m2025-11-08 15:53:24,942 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,943 - suricata_check.suricata_check - DEBUG - Processing rule: 1999011 on line 33[0m
[33m[1m2025-11-08 15:53:24,943 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,944 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,944 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999011, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16 03|"'}, {'name': 'depth', 'value': '2'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '1'}, {'name': 'byte_jump', 'value': '1, 37, relative, big'}, {'name': 'byte_jump', 'value': '2, 0, relative, big'}, {'name': 'byte_jump', 'value': '1, 0, relative, big'}, {'name': 'byte_extract', 'value': '2, 0, ext_len, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_domain,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999011'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'content': '!"|00 00|"', 'depth': '2', 'distance': '0', 'within': '2', 'byte_jump': '2, 2, relative, big', 'byte_extract': '2, 0, ext_len, relative, big', 'isdataat': '1, relative', 'xbits': 'isnotset,koen_supports_sni_domain,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:24,945 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,945 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,945 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,946 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,946 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,946 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,947 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,947 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,947 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,948 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,948 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,949 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,949 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,949 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,950 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,951 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,952 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,953 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,954 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,955 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,955 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,957 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,958 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,960 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,961 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,961 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,962 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth', 'content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,962 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,962 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,963 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:24,963 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:24,963 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,964 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,964 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,965 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999011, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16 03|"'}, {'name': 'depth', 'value': '2'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '1'}, {'name': 'byte_jump', 'value': '1, 37, relative, big'}, {'name': 'byte_jump', 'value': '2, 0, relative, big'}, {'name': 'byte_jump', 'value': '1, 0, relative, big'}, {'name': 'byte_extract', 'value': '2, 0, ext_len, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_domain,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999011'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999011; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'content': '!"|00 00|"', 'depth': '2', 'distance': '0', 'within': '2', 'byte_jump': '2, 2, relative, big', 'byte_extract': '2, 0, ext_len, relative, big', 'isdataat': '1, relative', 'xbits': 'isnotset,koen_supports_sni_domain,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:24,965 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,965 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,966 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,966 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,966 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,967 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,967 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,967 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,967 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999011[0m
[2m2025-11-08 15:53:24,969 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,969 - suricata_check.suricata_check - DEBUG - Processing rule: 1999012 on line 34[0m
[33m[1m2025-11-08 15:53:24,970 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,970 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,970 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999012, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16 03|"'}, {'name': 'depth', 'value': '2'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '1'}, {'name': 'byte_jump', 'value': '1, 37, relative, big'}, {'name': 'byte_jump', 'value': '2, 0, relative, big'}, {'name': 'byte_jump', 'value': '1, 0, relative, big'}, {'name': 'byte_extract', 'value': '2, 0, ext_len, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_domain,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999012'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'content': '!"|00 00|"', 'depth': '2', 'distance': '0', 'within': '2', 'byte_jump': '2, 2, relative, big', 'byte_extract': '2, 0, ext_len, relative, big', 'isdataat': '1, relative', 'xbits': 'isnotset,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:24,971 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,971 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,971 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,971 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,972 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,972 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,972 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,973 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,973 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,973 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,974 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,974 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,974 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,975 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,975 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,976 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,977 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,978 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,978 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,979 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,979 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,981 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,982 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth'), ('content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump'), ('content', 'distance', 'within', 'isdataat', 'byte_jump')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,984 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,985 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,985 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,985 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'depth', 'content', 'distance', 'within', 'byte_jump', 'byte_jump', 'byte_jump', 'byte_extract', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump', 'content', 'distance', 'within', 'isdataat', 'byte_jump'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,986 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,986 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,987 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:24,987 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:24,987 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,988 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,988 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:24,988 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999012, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16 03|"'}, {'name': 'depth', 'value': '2'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '1'}, {'name': 'byte_jump', 'value': '1, 37, relative, big'}, {'name': 'byte_jump', 'value': '2, 0, relative, big'}, {'name': 'byte_jump', 'value': '1, 0, relative, big'}, {'name': 'byte_extract', 'value': '2, 0, ext_len, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'content', 'value': '!"|00 00|"'}, {'name': 'distance', 'value': '0'}, {'name': 'within', 'value': '2'}, {'name': 'isdataat', 'value': '1, relative'}, {'name': 'byte_jump', 'value': '2, 2, relative, big'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_domain,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999012'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello without Server Name Indication (SNI)"; flow:established,to_server; content:"|16 03|"; depth:2; content:"|01|"; distance:3; within:1; byte_jump:1, 37, relative, big; byte_jump:2, 0, relative, big; byte_jump:1, 0, relative, big; byte_extract:2, 0, ext_len, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; content:!"|00 00|"; distance:0; within:2; isdataat:1, relative; byte_jump:2, 2, relative, big; xbits:isset,koen_supports_sni,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999012; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'content': '!"|00 00|"', 'depth': '2', 'distance': '0', 'within': '2', 'byte_jump': '2, 2, relative, big', 'byte_extract': '2, 0, ext_len, relative, big', 'isdataat': '1, relative', 'xbits': 'isnotset,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:24,989 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,989 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,989 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,990 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,990 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,990 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,990 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,991 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:24,991 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999012[0m
[2m2025-11-08 15:53:24,992 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:24,993 - suricata_check.suricata_check - DEBUG - Processing rule: 1999020 on line 37[0m
[33m[1m2025-11-08 15:53:24,993 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:24,993 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999020[0m
[2m2025-11-08 15:53:24,994 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999020, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_domain,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999020'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"', 'xbits': 'isnotset,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:24,994 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,994 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,995 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999020[0m
[2m2025-11-08 15:53:24,995 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999020[0m
[2m2025-11-08 15:53:24,995 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,996 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,996 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,996 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,996 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999020[0m
[2m2025-11-08 15:53:24,997 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,997 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,997 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:24,998 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:24,998 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:24,998 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999020[0m
[2m2025-11-08 15:53:24,999 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:24,999 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,000 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,000 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,001 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,001 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,002 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,002 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,004 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999020[0m
[2m2025-11-08 15:53:25,004 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999020[0m
[2m2025-11-08 15:53:25,005 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999020[0m
[2m2025-11-08 15:53:25,005 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,005 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999020[0m
[2m2025-11-08 15:53:25,006 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999020[0m
[2m2025-11-08 15:53:25,006 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,006 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,007 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999020[0m
[2m2025-11-08 15:53:25,007 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,007 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,008 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999020, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_domain,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999020'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with Internet Protocol version 4 (IPv4) address as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_domain,track ip_dst; xbits:isnotset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999020; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"', 'xbits': 'isnotset,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,008 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,008 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,008 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,009 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,009 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,009 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999020[0m
[2m2025-11-08 15:53:25,010 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,010 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,010 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999020[0m
[2m2025-11-08 15:53:25,011 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,012 - suricata_check.suricata_check - DEBUG - Processing rule: 1999021 on line 38[0m
[33m[1m2025-11-08 15:53:25,012 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,012 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,013 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999021, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_domain,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999021'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"', 'xbits': 'isnotset,koen_supports_sni_domain,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,013 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,013 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,014 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,014 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,014 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,015 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,015 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,015 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,016 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,016 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,016 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,017 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,017 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,017 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,018 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,018 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,019 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,019 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,020 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,020 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,021 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,021 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,022 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,023 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,023 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,024 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,024 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,024 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,025 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,025 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,025 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,026 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,026 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,026 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,027 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999021, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni,track ip_dst'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'xbits', 'value': 'isnotset,koen_supports_sni_domain,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999021'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with domain name as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"; xbits:isset,koen_supports_sni,track ip_dst; xbits:isset,koen_supports_sni_ipv4,track ip_dst; xbits:isnotset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999021; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"', 'xbits': 'isnotset,koen_supports_sni_domain,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,027 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,027 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,028 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,028 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,028 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,028 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,029 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,029 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni', None), ('track', 'ip_dst'), ('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst'), ('isnotset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,029 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999021[0m
[2m2025-11-08 15:53:25,031 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,031 - suricata_check.suricata_check - DEBUG - Processing rule: 1999030 on line 41[0m
[33m[1m2025-11-08 15:53:25,032 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,032 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,032 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999030, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '!"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"'}, {'name': 'pcre', 'value': '!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999030'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"; pcre:!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"', 'xbits': 'isset,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,033 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,033 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,034 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,034 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,034 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,034 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,035 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,035 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,035 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,036 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,036 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,036 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,037 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,037 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,037 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,038 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,038 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,039 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,040 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,040 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,040 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,041 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,041 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,043 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,043 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,044 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,044 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre', 'pcre'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,045 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,045 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,045 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,046 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,046 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,047 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,047 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,047 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999030, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '!"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"'}, {'name': 'pcre', 'value': '!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_ipv4,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999030'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while Internet Protocol version 4 (IPv4) address was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"; pcre:!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_ipv4,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999030; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"', 'xbits': 'isset,koen_supports_sni_ipv4,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,047 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,048 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,048 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,049 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,049 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,049 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,049 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,050 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni_ipv4', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,050 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999030[0m
[2m2025-11-08 15:53:25,051 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,051 - suricata_check.suricata_check - DEBUG - Processing rule: 1999031 on line 42[0m
[33m[1m2025-11-08 15:53:25,052 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,052 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,053 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999031, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '!"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"'}, {'name': 'pcre', 'value': '!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_domain,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999031'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"; pcre:!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"', 'xbits': 'isset,koen_supports_sni_domain,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,053 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,053 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,054 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,054 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,054 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,055 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,055 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,055 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,055 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,056 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,056 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,057 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,057 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,057 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,058 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,058 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,059 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,059 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,060 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,060 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,061 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,061 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,062 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre'), ('pcre',)) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,064 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,064 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,064 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,065 - suricata_check.utils.checker - DEBUG - Detected sequences (('tls.sni', 'pcre', 'pcre'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\d\-]+\.)+[a-zA-Z\d\-]+/"; pcre:!"/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,065 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,066 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,066 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,066 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,067 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,067 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,067 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,068 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999031, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'tls.sni', 'value': None}, {'name': 'pcre', 'value': '!"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"'}, {'name': 'pcre', 'value': '!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"'}, {'name': 'xbits', 'value': 'isset,koen_supports_sni_domain,track ip_dst'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999031'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTPS (HTTP/TLS) Client Hello with unexpected as Server Name Indication (SNI) while domain name was expected as SNI"; flow:established,to_server; tls.sni; pcre:!"/([a-zA-Z\\d\\-]+\\.)+[a-zA-Z\\d\\-]+/"; pcre:!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"; xbits:isset,koen_supports_sni_domain,track ip_dst; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999031; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'tls.sni': None, 'pcre': '!"/[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}/"', 'xbits': 'isset,koen_supports_sni_domain,track ip_dst', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,068 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,068 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,069 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,069 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,069 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,070 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,070 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,070 - suricata_check.utils.checker - DEBUG - [('isset', None), ('koen_supports_sni_domain', None), ('track', 'ip_dst')][0m
[2m2025-11-08 15:53:25,071 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999031[0m
[2m2025-11-08 15:53:25,072 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,072 - suricata_check.suricata_check - DEBUG - Processing rule: 1999040 on line 45[0m
[33m[1m2025-11-08 15:53:25,073 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,073 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,073 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999040, 'rev': 1, 'msg': 'KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|15|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02 46|"'}, {'name': 'distance', 'value': '4'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999040'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls $HOME_NET any -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"|02 46|"', 'offset': '0', 'depth': '1', 'distance': '4', 'threshold': 'type both,track by_both,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,074 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,074 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,074 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,074 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,075 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,075 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,075 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,076 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,076 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,076 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,077 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,077 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,077 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,078 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,078 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,079 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,079 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,080 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,081 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,081 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,082 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,082 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,083 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,085 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,085 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,086 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,086 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'content', 'distance'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,086 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,087 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,087 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,087 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,088 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,088 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,088 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,089 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999040, 'rev': 1, 'msg': 'KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|15|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02 46|"'}, {'name': 'distance', 'value': '4'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999040'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls $HOME_NET any -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"|02 46|"', 'offset': '0', 'depth': '1', 'distance': '4', 'threshold': 'type both,track by_both,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,089 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,089 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,090 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999040, 'rev': 1, 'msg': 'KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|15|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02 46|"'}, {'name': 'distance', 'value': '4'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999040'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN INFO Outbound TLS Fatal Alert due to Unsupported Protocol Version"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 46|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999040; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls $HOME_NET any -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"|02 46|"', 'offset': '0', 'depth': '1', 'distance': '4', 'threshold': 'type both,track by_both,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,090 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,090 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,091 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,091 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,091 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,092 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,092 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999040[0m
[2m2025-11-08 15:53:25,093 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,093 - suricata_check.suricata_check - DEBUG - Processing rule: 1999041 on line 46[0m
[33m[1m2025-11-08 15:53:25,094 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,094 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,095 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999041, 'rev': 1, 'msg': 'KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-attack', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|15|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02 2f|"'}, {'name': 'distance', 'value': '4'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-attack'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999041'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $HOME_NET any -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"|02 2f|"', 'offset': '0', 'depth': '1', 'distance': '4', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,095 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,095 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,095 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,096 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,096 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,096 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,097 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,097 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,097 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,097 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,098 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,098 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,098 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,099 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,099 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,100 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,100 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,101 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,101 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,102 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,102 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,103 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,103 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,105 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,105 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,105 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,106 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'content', 'distance'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,106 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,106 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,107 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,107 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,108 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,108 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,108 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,108 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999041, 'rev': 1, 'msg': 'KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-attack', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|15|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02 2f|"'}, {'name': 'distance', 'value': '4'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-attack'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999041'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $HOME_NET any -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"|02 2f|"', 'offset': '0', 'depth': '1', 'distance': '4', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,109 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,109 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,109 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999041, 'rev': 1, 'msg': 'KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-attack', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|15|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02 2f|"'}, {'name': 'distance', 'value': '4'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-attack'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999041'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Illegal Parameter"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 2f|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:2; gid:1999; sid:1999041; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tls $HOME_NET any -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"|02 2f|"', 'offset': '0', 'depth': '1', 'distance': '4', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,110 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,110 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,110 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,111 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,111 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,111 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,111 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999041[0m
[2m2025-11-08 15:53:25,112 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,113 - suricata_check.suricata_check - DEBUG - Processing rule: 1999042 on line 47[0m
[33m[1m2025-11-08 15:53:25,113 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,113 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,114 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999042, 'rev': 1, 'msg': 'KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|15|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02 28|"'}, {'name': 'distance', 'value': '4'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999042'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls $HOME_NET any -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"|02 28|"', 'offset': '0', 'depth': '1', 'distance': '4', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,114 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,115 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,115 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,115 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,116 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,116 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,116 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,116 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,117 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,117 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,117 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,118 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,118 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,118 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,119 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,119 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,120 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,121 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,121 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,121 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,122 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,122 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,123 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,124 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,125 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,125 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,126 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'content', 'distance'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,126 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,126 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,127 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,127 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,127 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,128 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,128 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,128 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999042, 'rev': 1, 'msg': 'KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|15|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02 28|"'}, {'name': 'distance', 'value': '4'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999042'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls $HOME_NET any -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"|02 28|"', 'offset': '0', 'depth': '1', 'distance': '4', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,129 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,129 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,129 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999042, 'rev': 1, 'msg': 'KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-activity', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|15|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02 28|"'}, {'name': 'distance', 'value': '4'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-activity'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999042'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound TLS Fatal Alert due to Handshake Failure"; flow:established,to_client; content:"|15|"; offset:0; depth:1; content:"|02 28|"; distance:4; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-activity; priority:3; gid:1999; sid:1999042; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls $HOME_NET any -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"|02 28|"', 'offset': '0', 'depth': '1', 'distance': '4', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,130 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,130 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,130 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,130 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,131 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,131 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,131 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999042[0m
[2m2025-11-08 15:53:25,132 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,132 - suricata_check.suricata_check - DEBUG - Processing rule: 1999050 on line 50[0m
[33m[1m2025-11-08 15:53:25,133 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,133 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,134 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HOME_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999050, 'rev': 1, 'msg': 'KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-attack', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-attack'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999050'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls $EXTERNAL_NET any -> $HOME_NET any', 'flow': 'established,to_server', 'content': '"|03 01|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,134 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,134 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,135 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,135 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,135 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,136 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,136 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,136 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,137 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,137 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,137 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,138 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,138 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Informational')][0m
[2m2025-11-08 15:53:25,138 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,139 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,140 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,140 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,141 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,142 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,142 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,142 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,143 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,144 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,146 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,146 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,147 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,147 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'content', 'distance', 'within', 'content', 'distance', 'content', 'distance', 'within'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)[0m
[2m2025-11-08 15:53:25,147 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,148 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,148 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,148 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,149 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,149 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,149 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,150 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HOME_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999050, 'rev': 1, 'msg': 'KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-attack', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-attack'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999050'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls $EXTERNAL_NET any -> $HOME_NET any', 'flow': 'established,to_server', 'content': '"|03 01|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,150 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,150 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,151 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HOME_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999050, 'rev': 1, 'msg': 'KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Informational'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'misc-attack', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'misc-attack'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999050'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational'}], 'raw': 'alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"KOEN HUNTING Inbound TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:misc-attack; priority:3; gid:1999; sid:1999050; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Informational;)', 'header': 'alert tls $EXTERNAL_NET any -> $HOME_NET any', 'flow': 'established,to_server', 'content': '"|03 01|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,151 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,151 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,151 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,152 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,152 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,152 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,153 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999050[0m
[2m2025-11-08 15:53:25,154 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,154 - suricata_check.suricata_check - DEBUG - Processing rule: 1999051 on line 51[0m
[33m[1m2025-11-08 15:53:25,155 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,155 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,155 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999051, 'rev': 1, 'msg': 'KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'policy-violation', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'policy-violation'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999051'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_server', 'content': '"|03 01|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,156 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,156 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,156 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,157 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,157 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,157 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,158 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,158 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,158 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,159 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,159 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,159 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,160 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,160 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,160 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,161 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,161 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,163 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,163 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,164 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,164 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,165 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,166 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,168 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,168 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,169 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,169 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'content', 'distance', 'within', 'content', 'distance', 'content', 'distance', 'within'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,170 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,170 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,171 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,171 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,171 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,172 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,172 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,172 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999051, 'rev': 1, 'msg': 'KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'policy-violation', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'policy-violation'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999051'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_server', 'content': '"|03 01|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,173 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,173 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,173 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999051, 'rev': 1, 'msg': 'KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'policy-violation', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'policy-violation'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999051'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.0"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999051; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_server', 'content': '"|03 01|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,173 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,174 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,174 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,174 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,175 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,175 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,175 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999051[0m
[2m2025-11-08 15:53:25,176 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,176 - suricata_check.suricata_check - DEBUG - Processing rule: 1999052 on line 52[0m
[33m[1m2025-11-08 15:53:25,177 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,177 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,178 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999052, 'rev': 1, 'msg': 'KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'policy-violation', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 02|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'policy-violation'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999052'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_server', 'content': '"|03 02|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,178 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,178 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,179 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,179 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,179 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,180 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,180 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,180 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,181 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,181 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,181 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,182 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,182 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,182 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,183 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,183 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,184 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,185 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,186 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,186 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,187 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,188 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,188 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,190 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,190 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,191 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,191 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'content', 'distance', 'within', 'content', 'distance', 'content', 'distance', 'within'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,191 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,192 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,192 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,192 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,193 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,193 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,193 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,194 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999052, 'rev': 1, 'msg': 'KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'policy-violation', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 02|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'policy-violation'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999052'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_server', 'content': '"|03 02|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,194 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,194 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,195 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999052, 'rev': 1, 'msg': 'KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'policy-violation', 'priority': '3', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|01|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 02|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'policy-violation'}, {'name': 'priority', 'value': '3'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999052'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Host sending TLS Client Hello supporting TLS 1.1"; flow:established,to_server; content:"|16|"; offset:0; depth:1; content:"|01|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:policy-violation; priority:3; gid:1999; sid:1999052; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_server', 'content': '"|03 02|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,195 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,195 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,196 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,196 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,196 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,196 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,197 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999052[0m
[2m2025-11-08 15:53:25,198 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,198 - suricata_check.suricata_check - DEBUG - Processing rule: 1999053 on line 53[0m
[33m[1m2025-11-08 15:53:25,199 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,199 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,199 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999053, 'rev': 1, 'msg': 'KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'web-application-activity', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'web-application-activity'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999053'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_client', 'content': '"|03 01|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,200 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,200 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,200 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,201 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,201 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,201 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,202 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,202 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,202 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,202 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,203 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,203 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,203 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,204 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,204 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,205 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,205 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,206 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,207 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,207 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,208 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,209 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,209 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,211 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,211 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,212 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,212 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'content', 'distance', 'within', 'content', 'distance', 'content', 'distance', 'within'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,213 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,213 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,213 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,214 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,214 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,214 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,215 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,215 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999053, 'rev': 1, 'msg': 'KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'web-application-activity', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'web-application-activity'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999053'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_client', 'content': '"|03 01|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,215 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,216 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,216 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999053, 'rev': 1, 'msg': 'KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'web-application-activity', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 01|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'web-application-activity'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999053'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.0"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 01|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999053; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_client', 'content': '"|03 01|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,216 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,217 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,217 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,217 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,218 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,218 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,218 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999053[0m
[2m2025-11-08 15:53:25,219 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,220 - suricata_check.suricata_check - DEBUG - Processing rule: 1999054 on line 54[0m
[33m[1m2025-11-08 15:53:25,220 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,220 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,221 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999054, 'rev': 1, 'msg': 'KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'web-application-activity', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 02|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'web-application-activity'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999054'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_client', 'content': '"|03 02|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,221 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,221 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,222 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,222 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,222 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,223 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,223 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,223 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,224 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,224 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,224 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,225 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,225 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Policy')][0m
[2m2025-11-08 15:53:25,225 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,226 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,226 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,227 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,228 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,228 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,229 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,229 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,230 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,231 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('content', 'distance', 'within'), ('content', 'distance'), ('content', 'distance', 'within')) separated by ('content', 'pcre') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,233 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,233 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,234 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,234 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'content', 'distance', 'within', 'content', 'distance', 'content', 'distance', 'within'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)[0m
[2m2025-11-08 15:53:25,234 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,235 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,235 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,235 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,236 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,236 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,236 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,237 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999054, 'rev': 1, 'msg': 'KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'web-application-activity', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 02|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'web-application-activity'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999054'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_client', 'content': '"|03 02|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,237 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,237 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,238 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tls', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999054, 'rev': 1, 'msg': 'KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Policy'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'web-application-activity', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"|16|"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '1'}, {'name': 'content', 'value': '"|02|"'}, {'name': 'distance', 'value': '4'}, {'name': 'within', 'value': '1'}, {'name': 'content', 'value': '"|00 2b|"'}, {'name': 'distance', 'value': '0'}, {'name': 'content', 'value': '"|03 02|"'}, {'name': 'distance', 'value': '3'}, {'name': 'within', 'value': '8'}, {'name': 'threshold', 'value': 'type both,track by_src,count 1,seconds 3600'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'web-application-activity'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999054'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy'}], 'raw': 'alert tls $HOME_NET any -> any any (msg:"KOEN POLICY Internal Server sending TLS Server Hello supporting TLS 1.1"; flow:established,to_client; content:"|16|"; offset:0; depth:1; content:"|02|"; distance:4; within:1; content:"|00 2b|"; distance:0; content:"|03 02|"; distance:3; within:8; threshold:type both,track by_src,count 1,seconds 3600; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:web-application-activity; priority:2; gid:1999; sid:1999054; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Policy;)', 'header': 'alert tls $HOME_NET any -> any any', 'flow': 'established,to_client', 'content': '"|03 02|"', 'offset': '0', 'depth': '1', 'distance': '3', 'within': '8', 'threshold': 'type both,track by_src,count 1,seconds 3600'}.[0m
[2m2025-11-08 15:53:25,238 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,238 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,238 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,239 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,239 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,239 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,239 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999054[0m
[2m2025-11-08 15:53:25,240 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,241 - suricata_check.suricata_check - DEBUG - Processing rule: 1999060 on line 57[0m
[33m[1m2025-11-08 15:53:25,241 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,242 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,242 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999060, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'pcre', 'value': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999060'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'pcre': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,242 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,243 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,243 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,243 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,244 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,244 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,244 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,244 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,245 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,245 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,245 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,246 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,246 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,246 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,247 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,247 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,247 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,248 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,249 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,249 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,249 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,250 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,250 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,252 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,252 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,252 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,253 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,253 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,253 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,254 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,254 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,254 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,255 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,255 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,255 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999060, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'pcre', 'value': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999060'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'pcre': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,256 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,256 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,256 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$EXTERNAL_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$HTTP_SERVERS', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999060, 'rev': 1, 'msg': 'KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'pcre', 'value': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999060'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"KOEN HUNTING Inbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999060; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443', 'flow': 'established,to_server', 'pcre': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,256 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,257 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,257 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,257 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,258 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,258 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,258 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999060[0m
[2m2025-11-08 15:53:25,259 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,259 - suricata_check.suricata_check - DEBUG - Processing rule: 1999061 on line 58[0m
[33m[1m2025-11-08 15:53:25,260 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,260 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,261 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$HTTP_SERVERS', 'source_port': '443', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999061, 'rev': 1, 'msg': 'KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"HTTP"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '4'}, {'name': 'pcre', 'value': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999061'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"HTTP"', 'offset': '0', 'depth': '4', 'pcre': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,261 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,261 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,261 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,262 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,262 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,262 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,262 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,263 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,263 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,263 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,264 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,264 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,264 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Minor')][0m
[2m2025-11-08 15:53:25,265 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,265 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,266 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,266 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,267 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,267 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,268 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,268 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,268 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,269 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,270 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,271 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,271 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,271 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'pcre'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)[0m
[2m2025-11-08 15:53:25,272 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,272 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,272 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,273 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,273 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,273 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,274 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,274 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$HTTP_SERVERS', 'source_port': '443', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999061, 'rev': 1, 'msg': 'KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"HTTP"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '4'}, {'name': 'pcre', 'value': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999061'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"HTTP"', 'offset': '0', 'depth': '4', 'pcre': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,274 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,275 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,275 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$HTTP_SERVERS', 'source_port': '443', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999061, 'rev': 1, 'msg': 'KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Minor'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'non-standard-protocol', 'priority': '2', 'options': [{'name': 'msg', 'value': '"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"HTTP"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '4'}, {'name': 'pcre', 'value': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'non-standard-protocol'}, {'name': 'priority', 'value': '2'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999061'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor'}], 'raw': 'alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"KOEN HUNTING Outbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:non-standard-protocol; priority:2; gid:1999; sid:1999061; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Minor;)', 'header': 'alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any', 'flow': 'established,to_client', 'content': '"HTTP"', 'offset': '0', 'depth': '4', 'pcre': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,275 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,276 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,276 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,276 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,276 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,277 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,277 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999061[0m
[2m2025-11-08 15:53:25,278 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,279 - suricata_check.suricata_check - DEBUG - Processing rule: 1999062 on line 59[0m
[33m[1m2025-11-08 15:53:25,279 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,279 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,280 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999062, 'rev': 1, 'msg': 'KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Major'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'command-and-control', 'priority': '1', 'options': [{'name': 'msg', 'value': '"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'pcre', 'value': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'command-and-control'}, {'name': 'priority', 'value': '1'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999062'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major'}], 'raw': 'alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)', 'header': 'alert tcp $HOME_NET any -> $EXTERNAL_NET 443', 'flow': 'established,to_server', 'pcre': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,280 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,280 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,281 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,281 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,281 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,282 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,282 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,282 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,283 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,283 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,283 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,284 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,284 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,284 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,285 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,285 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,286 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,286 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,287 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,287 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,287 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,288 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,288 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('content', 'pcre') in rule alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,289 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,290 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,290 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,290 - suricata_check.utils.checker - DEBUG - Detected sequences (('pcre',),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\s[a-zA-Z0-9\.\/\?\&\=\_\~\#\:]+\sHTTP/[\d](\.[\d])?\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,291 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,291 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,291 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,292 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,292 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,293 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,293 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_server', None)][0m
[2m2025-11-08 15:53:25,293 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999062, 'rev': 1, 'msg': 'KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Major'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'command-and-control', 'priority': '1', 'options': [{'name': 'msg', 'value': '"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'pcre', 'value': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'command-and-control'}, {'name': 'priority', 'value': '1'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999062'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major'}], 'raw': 'alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)', 'header': 'alert tcp $HOME_NET any -> $EXTERNAL_NET 443', 'flow': 'established,to_server', 'pcre': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,294 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,294 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,294 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$HOME_NET', 'source_port': 'any', 'direction': '->', 'dest_addr': '$EXTERNAL_NET', 'dest_port': '443', 'group': None, 'gid': 1999, 'sid': 1999062, 'rev': 1, 'msg': 'KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Major'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'command-and-control', 'priority': '1', 'options': [{'name': 'msg', 'value': '"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_server'}, {'name': 'pcre', 'value': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'src_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'command-and-control'}, {'name': 'priority', 'value': '1'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999062'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major'}], 'raw': 'alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"KOEN C2 Outbound HTTP Request over HTTPS (HTTP/TLS) port"; flow:established,to_server; pcre:"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:src_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999062; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)', 'header': 'alert tcp $HOME_NET any -> $EXTERNAL_NET 443', 'flow': 'established,to_server', 'pcre': '"/^(GET|HEAD|POST|PUT|DELETE|CONNECT|OPTIONS|TRACE|PATCH)\\s[a-zA-Z0-9\\.\\/\\?\\&\\=\\_\\~\\#\\:]+\\sHTTP/[\\d](\\.[\\d])?\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'src_ip'}.[0m
[2m2025-11-08 15:53:25,295 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,295 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,295 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,295 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,296 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,296 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,296 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999062[0m
[2m2025-11-08 15:53:25,297 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,298 - suricata_check.suricata_check - DEBUG - Processing rule: 1999063 on line 60[0m
[33m[1m2025-11-08 15:53:25,298 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,299 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,299 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$EXTERNAL_NET', 'source_port': '443', 'direction': '->', 'dest_addr': '$HOME_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999063, 'rev': 1, 'msg': 'KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Major'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'command-and-control', 'priority': '1', 'options': [{'name': 'msg', 'value': '"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"HTTP"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '4'}, {'name': 'pcre', 'value': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'command-and-control'}, {'name': 'priority', 'value': '1'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999063'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major'}], 'raw': 'alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)', 'header': 'alert tcp $EXTERNAL_NET 443 -> $HOME_NET any', 'flow': 'established,to_client', 'content': '"HTTP"', 'offset': '0', 'depth': '4', 'pcre': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,299 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,299 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,300 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,300 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,300 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,301 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,301 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,301 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,301 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,302 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,302 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,302 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,303 - suricata_check.utils.checker - DEBUG - [('affected_product', 'Any'), ('attack_target', 'Client_Endpoint'), ('created_at', '2024_03_06'), ('deployment', 'Perimeter'), ('performance_impact', 'Low'), ('signature_severity', 'Major')][0m
[2m2025-11-08 15:53:25,303 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,303 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,304 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,304 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,305 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,306 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,306 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,307 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,307 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,308 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth'), ('pcre',)) separated by ('content', 'pcre') in rule alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,309 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,309 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,310 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,310 - suricata_check.utils.checker - DEBUG - Detected sequences (('content', 'offset', 'depth', 'pcre'),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\d](\.[\d])?\s\d{3}[\s\w]+\s\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)[0m
[2m2025-11-08 15:53:25,311 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,311 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,311 - suricata_check.checkers.styleguide.sid - DEBUG - Detected sid from range: local[0m
[2m2025-11-08 15:53:25,312 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: KOEN[0m
[2m2025-11-08 15:53:25,312 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,312 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,313 - suricata_check.utils.checker - DEBUG - [('established', None), ('to_client', None)][0m
[2m2025-11-08 15:53:25,313 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$EXTERNAL_NET', 'source_port': '443', 'direction': '->', 'dest_addr': '$HOME_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999063, 'rev': 1, 'msg': 'KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Major'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'command-and-control', 'priority': '1', 'options': [{'name': 'msg', 'value': '"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"HTTP"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '4'}, {'name': 'pcre', 'value': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'command-and-control'}, {'name': 'priority', 'value': '1'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999063'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major'}], 'raw': 'alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)', 'header': 'alert tcp $EXTERNAL_NET 443 -> $HOME_NET any', 'flow': 'established,to_client', 'content': '"HTTP"', 'offset': '0', 'depth': '4', 'pcre': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,314 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,314 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,314 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'tcp', 'source_addr': '$EXTERNAL_NET', 'source_port': '443', 'direction': '->', 'dest_addr': '$HOME_NET', 'dest_port': 'any', 'group': None, 'gid': 1999, 'sid': 1999063, 'rev': 1, 'msg': 'KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port', 'flowbits': [], 'metadata': ['affected_product Any', 'attack_target Client_Endpoint', 'created_at 2024_03_06', 'deployment Perimeter', 'performance_impact Low', 'signature_severity Major'], 'references': ['url,koen.teuwen.net/report/tls-web-attack-detection'], 'classtype': 'command-and-control', 'priority': '1', 'options': [{'name': 'msg', 'value': '"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"'}, {'name': 'flow', 'value': 'established,to_client'}, {'name': 'content', 'value': '"HTTP"'}, {'name': 'offset', 'value': '0'}, {'name': 'depth', 'value': '4'}, {'name': 'pcre', 'value': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"'}, {'name': 'threshold', 'value': 'type both,track by_both,count 1,seconds 3600'}, {'name': 'target', 'value': 'dest_ip'}, {'name': 'reference', 'value': 'url,koen.teuwen.net/report/tls-web-attack-detection'}, {'name': 'classtype', 'value': 'command-and-control'}, {'name': 'priority', 'value': '1'}, {'name': 'gid', 'value': '1999'}, {'name': 'sid', 'value': '1999063'}, {'name': 'rev', 'value': '1'}, {'name': 'metadata', 'value': 'affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major'}], 'raw': 'alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"KOEN C2 Inbound HTTP Response over HTTPS (HTTP/TLS) port"; flow:established,to_client; content:"HTTP"; offset:0; depth:4; pcre:"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"; threshold:type both,track by_both,count 1,seconds 3600; target:dest_ip; reference:url,koen.teuwen.net/report/tls-web-attack-detection; classtype:command-and-control; priority:1; gid:1999; sid:1999063; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2024_03_06, deployment Perimeter, performance_impact Low, signature_severity Major;)', 'header': 'alert tcp $EXTERNAL_NET 443 -> $HOME_NET any', 'flow': 'established,to_client', 'content': '"HTTP"', 'offset': '0', 'depth': '4', 'pcre': '"/^HTTP/[\\d](\\.[\\d])?\\s\\d{3}[\\s\\w]+\\s\\n/"', 'threshold': 'type both,track by_both,count 1,seconds 3600', 'target': 'dest_ip'}.[0m
[2m2025-11-08 15:53:25,314 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,315 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,315 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,315 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,316 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,316 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,316 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1999063[0m
[2m2025-11-08 15:53:25,317 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule {'enabled': True, 'action': 'alert', 'proto': 'dns', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'contains dns to detectme.foobar', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"contains dns to detectme.foobar"'}, {'name': 'content', 'value': '"detectme.foobar"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)', 'header': 'alert dns any any -> any any', 'content': '"detectme.foobar"'}.[0m
[2m2025-11-08 15:53:25,317 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,318 - suricata_check.suricata_check - DEBUG - Processing rule: 1 on line 66[0m
[33m[1m2025-11-08 15:53:25,318 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,318 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1[0m
[2m2025-11-08 15:53:25,319 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'dns', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'contains dns to detectme.foobar', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"contains dns to detectme.foobar"'}, {'name': 'content', 'value': '"detectme.foobar"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)', 'header': 'alert dns any any -> any any', 'content': '"detectme.foobar"'}.[0m
[2m2025-11-08 15:53:25,319 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,319 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,320 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1[0m
[2m2025-11-08 15:53:25,320 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1[0m
[2m2025-11-08 15:53:25,320 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,320 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,321 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,321 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,321 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,322 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1[0m
[2m2025-11-08 15:53:25,322 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,322 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,323 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,323 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,323 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,324 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1[0m
[2m2025-11-08 15:53:25,324 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,325 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,325 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,325 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,326 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,326 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,327 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,327 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,328 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1[0m
[2m2025-11-08 15:53:25,329 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1[0m
[2m2025-11-08 15:53:25,329 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1[0m
[2m2025-11-08 15:53:25,330 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)[0m
[2m2025-11-08 15:53:25,330 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1[0m
[2m2025-11-08 15:53:25,330 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1[0m
[2m2025-11-08 15:53:25,331 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: [0m
[2m2025-11-08 15:53:25,331 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1[0m
[2m2025-11-08 15:53:25,331 - suricata_check.utils.checker - DEBUG - Option flow not found in rule {'enabled': True, 'action': 'alert', 'proto': 'dns', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'contains dns to detectme.foobar', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"contains dns to detectme.foobar"'}, {'name': 'content', 'value': '"detectme.foobar"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)', 'header': 'alert dns any any -> any any', 'content': '"detectme.foobar"'}.[0m
[2m2025-11-08 15:53:25,331 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,332 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,332 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,332 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,333 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'dns', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'contains dns to detectme.foobar', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"contains dns to detectme.foobar"'}, {'name': 'content', 'value': '"detectme.foobar"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert dns any any -> any any (msg : "contains dns to detectme.foobar"; content : "detectme.foobar"; sid: 1;)', 'header': 'alert dns any any -> any any', 'content': '"detectme.foobar"'}.[0m
[2m2025-11-08 15:53:25,333 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,333 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,333 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,334 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1[0m
[2m2025-11-08 15:53:25,334 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,334 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,334 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1[0m
[2m2025-11-08 15:53:25,335 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule {'enabled': True, 'action': 'alert', 'proto': 'dns', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'contains dns to detectme.foobar', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"contains dns to detectme.foobar"'}, {'name': 'content', 'value': '"detectme.foobar"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )', 'header': 'alert dns any any -> any any', 'content': '"detectme.foobar"'}.[0m
[2m2025-11-08 15:53:25,336 - suricata_check.utils.checker - DEBUG - Option metadata not found in rule.[0m
[2m2025-11-08 15:53:25,336 - suricata_check.suricata_check - DEBUG - Processing rule: 1 on line 72[0m
[33m[1m2025-11-08 15:53:25,336 - suricata_check.suricata_check - WARNING - [][0m
[2m2025-11-08 15:53:25,337 - suricata_check.checkers.interface.checker - DEBUG - Running BestChecker on rule 1[0m
[2m2025-11-08 15:53:25,337 - suricata_check.utils.checker - DEBUG - Option flowbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'dns', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'contains dns to detectme.foobar', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"contains dns to detectme.foobar"'}, {'name': 'content', 'value': '"detectme.foobar"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )', 'header': 'alert dns any any -> any any', 'content': '"detectme.foobar"'}.[0m
[2m2025-11-08 15:53:25,337 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,338 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,338 - suricata_check.checkers.interface.checker - DEBUG - Running MandatoryChecker on rule 1[0m
[2m2025-11-08 15:53:25,338 - suricata_check.checkers.interface.checker - DEBUG - Running MetadataChecker on rule 1[0m
[2m2025-11-08 15:53:25,339 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,339 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,339 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,339 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,340 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,340 - suricata_check.checkers.interface.checker - DEBUG - Running MsgChecker on rule 1[0m
[2m2025-11-08 15:53:25,340 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,340 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,341 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,341 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,341 - suricata_check.checkers.styleguide.msg - DEBUG - Rule does not describe malware: alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,342 - suricata_check.checkers.interface.checker - DEBUG - Running OrderChecker on rule 1[0m
[2m2025-11-08 15:53:25,342 - suricata_check.utils.checker - DEBUG - Excluding name flow from other_names because of overlap.[0m
[2m2025-11-08 15:53:25,343 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,343 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,344 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,344 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,344 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,345 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,345 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('content', 'pcre') in rule alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,346 - suricata_check.checkers.interface.checker - DEBUG - Running OverallChecker on rule 1[0m
[2m2025-11-08 15:53:25,347 - suricata_check.checkers.interface.checker - DEBUG - Running PcreChecker on rule 1[0m
[2m2025-11-08 15:53:25,347 - suricata_check.checkers.interface.checker - DEBUG - Running PerformanceChecker on rule 1[0m
[2m2025-11-08 15:53:25,347 - suricata_check.utils.checker - DEBUG - Detected sequences (('content',),) separated by ('base64_data', 'dce.iface', 'dce.opnum', 'dce.stub_data', 'dce_iface', 'dce_opnum', 'dce_stub_data', 'dns.query', 'dns_query', 'file.data', 'file_data', 'http.accept', 'http.accept_enc', 'http.accept_lang', 'http.connection', 'http.content_len', 'http.content_type', 'http.cookie', 'http.header', 'http.header.raw', 'http.header_names', 'http.host', 'http.host.raw', 'http.location', 'http.method', 'http.protocol', 'http.referer', 'http.request_body', 'http.request_header', 'http.request_line', 'http.response_body', 'http.response_header', 'http.response_line', 'http.server', 'http.start', 'http.stat_code', 'http.stat_msg', 'http.uri', 'http.uri.raw', 'http.user_agent', 'http_accept', 'http_accept_enc', 'http_accept_lang', 'http_client_body', 'http_connection', 'http_content_len', 'http_content_type', 'http_cookie', 'http_header', 'http_header_names', 'http_host', 'http_method', 'http_protocol', 'http_raw_header', 'http_raw_host', 'http_raw_uri', 'http_referer', 'http_request_line', 'http_response_line', 'http_server_body', 'http_start', 'http_stat_code', 'http_stat_msg', 'http_uri', 'http_user_agent', 'ja3.hash', 'ja3_hash', 'ja3s.hash', 'tls.cert_fingerprint', 'tls.cert_issuer', 'tls.cert_serial', 'tls.cert_subject', 'tls.certs', 'tls.sni', 'tls.version', 'tls_cert_fingerprint', 'tls_cert_issuer', 'tls_cert_serial', 'tls_cert_subject', 'tls_sni') in rule alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )[0m
[2m2025-11-08 15:53:25,348 - suricata_check.checkers.interface.checker - DEBUG - Running ReferenceChecker on rule 1[0m
[2m2025-11-08 15:53:25,348 - suricata_check.checkers.interface.checker - DEBUG - Running SidChecker on rule 1[0m
[2m2025-11-08 15:53:25,348 - suricata_check.checkers.styleguide.sid - DEBUG - Detected prefix: [0m
[2m2025-11-08 15:53:25,349 - suricata_check.checkers.interface.checker - DEBUG - Running StateChecker on rule 1[0m
[2m2025-11-08 15:53:25,349 - suricata_check.utils.checker - DEBUG - Option flow not found in rule {'enabled': True, 'action': 'alert', 'proto': 'dns', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'contains dns to detectme.foobar', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"contains dns to detectme.foobar"'}, {'name': 'content', 'value': '"detectme.foobar"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )', 'header': 'alert dns any any -> any any', 'content': '"detectme.foobar"'}.[0m
[2m2025-11-08 15:53:25,349 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,349 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,350 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,350 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,350 - suricata_check.utils.checker - DEBUG - Option xbits not found in rule {'enabled': True, 'action': 'alert', 'proto': 'dns', 'source_addr': 'any', 'source_port': 'any', 'direction': '->', 'dest_addr': 'any', 'dest_port': 'any', 'group': None, 'gid': 1, 'sid': 1, 'rev': None, 'msg': 'contains dns to detectme.foobar', 'flowbits': [], 'metadata': [], 'references': [], 'classtype': None, 'priority': 0, 'options': [{'name': 'msg', 'value': '"contains dns to detectme.foobar"'}, {'name': 'content', 'value': '"detectme.foobar"'}, {'name': 'sid', 'value': '1'}], 'raw': 'alert dns any any -> any any ( msg:"contains dns to detectme.foobar"; content:"detectme.foobar"; sid:1; )', 'header': 'alert dns any any -> any any', 'content': '"detectme.foobar"'}.[0m
[2m2025-11-08 15:53:25,351 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,351 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,351 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,352 - suricata_check.checkers.interface.checker - DEBUG - Running UnexpectedChecker on rule 1[0m
[2m2025-11-08 15:53:25,352 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,352 - suricata_check.utils.checker - DEBUG - [][0m
[2m2025-11-08 15:53:25,352 - suricata_check.checkers.interface.checker - DEBUG - Running WhitespaceChecker on rule 1[0m
2025-11-08 15:53:25,353 - suricata_check.suricata_check - INFO - Completed processing rule file: tests\data\test.rules[0m
2025-11-08 15:53:25,354 - suricata_check._output - INFO - Writing output to suricata-check.jsonl and suricata-check-fast.log in C:\Users\lenovo\suricata-check[0m
[34m[C100] (INFO) Lines 7-7, sid 1: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[C101] (INFO) Lines 7-7, sid 1: The rule does not use set the `created_at` metadata option. Consider adding the `created_at` metadata option to inform users of the recency of this signature.[0m
[34m[S800] (INFO) Lines 7-7, sid 1: The rule did not specify the `attack_target` metadata option. Consider specifying the `attack_target` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S801] (INFO) Lines 7-7, sid 1: The rule did not specify the `signature_severity` metadata option. Consider specifying the `signature_severity` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S802] (INFO) Lines 7-7, sid 1: The rule did not specify the `performance_impact` metadata option. Consider specifying the `performance_impact` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S803] (INFO) Lines 7-7, sid 1: The rule did not specify the `deployment` metadata option. Consider specifying the `deployment` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S400] (INFO) Lines 7-7, sid 1: The rule has a non-standard format for the msg field. Consider changing the msg field to `RULESET CATEGORY Description`.[0m
[34m[S000] (INFO) Lines 7-7, sid 1: The rule did not specificy an inbound or outbound direction. Consider constraining the rule to a specific direction such as INBOUND or OUTBOUND traffic.[0m
[34m[S020] (INFO) Lines 7-7, sid 1: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S301] (INFO) Lines 7-7, sid 1: Allocation to unallocated SID range, whereas local range should be used. Consider using an sid in one of the following ranges: [(1000000, 1999999)].[0m
[34m[C100] (INFO) Lines 8-8, sid 1: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[C101] (INFO) Lines 8-8, sid 1: The rule does not use set the `created_at` metadata option. Consider adding the `created_at` metadata option to inform users of the recency of this signature.[0m
[34m[S800] (INFO) Lines 8-8, sid 1: The rule did not specify the `attack_target` metadata option. Consider specifying the `attack_target` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S801] (INFO) Lines 8-8, sid 1: The rule did not specify the `signature_severity` metadata option. Consider specifying the `signature_severity` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S802] (INFO) Lines 8-8, sid 1: The rule did not specify the `performance_impact` metadata option. Consider specifying the `performance_impact` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S803] (INFO) Lines 8-8, sid 1: The rule did not specify the `deployment` metadata option. Consider specifying the `deployment` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S400] (INFO) Lines 8-8, sid 1: The rule has a non-standard format for the msg field. Consider changing the msg field to `RULESET CATEGORY Description`.[0m
[34m[S000] (INFO) Lines 8-8, sid 1: The rule did not specificy an inbound or outbound direction. Consider constraining the rule to a specific direction such as INBOUND or OUTBOUND traffic.[0m
[34m[S020] (INFO) Lines 8-8, sid 1: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S301] (INFO) Lines 8-8, sid 1: Allocation to unallocated SID range, whereas local range should be used. Consider using an sid in one of the following ranges: [(1000000, 1999999)].[0m
[34m[C100] (INFO) Lines 9-9, sid 1: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[C101] (INFO) Lines 9-9, sid 1: The rule does not use set the `created_at` metadata option. Consider adding the `created_at` metadata option to inform users of the recency of this signature.[0m
[34m[S800] (INFO) Lines 9-9, sid 1: The rule did not specify the `attack_target` metadata option. Consider specifying the `attack_target` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S801] (INFO) Lines 9-9, sid 1: The rule did not specify the `signature_severity` metadata option. Consider specifying the `signature_severity` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S802] (INFO) Lines 9-9, sid 1: The rule did not specify the `performance_impact` metadata option. Consider specifying the `performance_impact` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S803] (INFO) Lines 9-9, sid 1: The rule did not specify the `deployment` metadata option. Consider specifying the `deployment` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S400] (INFO) Lines 9-9, sid 1: The rule has a non-standard format for the msg field. Consider changing the msg field to `RULESET CATEGORY Description`.[0m
[34m[S000] (INFO) Lines 9-9, sid 1: The rule did not specificy an inbound or outbound direction. Consider constraining the rule to a specific direction such as INBOUND or OUTBOUND traffic.[0m
[34m[S020] (INFO) Lines 9-9, sid 1: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S301] (INFO) Lines 9-9, sid 1: Allocation to unallocated SID range, whereas local range should be used. Consider using an sid in one of the following ranges: [(1000000, 1999999)].[0m
[34m[S800] (INFO) Lines 21-21, sid 1999000: The rule did not specify the `attack_target` metadata option. Consider specifying the `attack_target` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S011] (INFO) Lines 21-21, sid 1999000: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S020] (INFO) Lines 21-21, sid 1999000: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S600] (INFO) Lines 21-21, sid 1999000: The rule uses the `pcre` option but has no `content` option set. Consider using the content option atleast once to anchor and improve runtime performance.[0m
[34m[S520] (INFO) Lines 21-21, sid 1999000: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[S522] (INFO) Lines 21-21, sid 1999000: The rule sets a xbit but does not explcitly set the expire option. Consider setting the expire option to indicate for how long the xbit remains relevant.[0m
[34m[C000] (WARNING) Lines 21-21, sid 1999000: The rule uses the Suricata threshold option in combination with the setting of flowbits or xbits. Note that the flowbit or xbit will be set on every match regardless of whether the threshold is reached. Consider removing the `threshold` option from the rule to prevent confusion.[0m
[34m[S123] (INFO) Lines 21-21, sid 1999000: The rule escaped special characters using a blackslash (\) in a pcre field. Consider using hex encoding instead.[0m
[34m[C100] (INFO) Lines 22-22, sid 1999001: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[S800] (INFO) Lines 22-22, sid 1999001: The rule did not specify the `attack_target` metadata option. Consider specifying the `attack_target` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S011] (INFO) Lines 22-22, sid 1999001: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S020] (INFO) Lines 22-22, sid 1999001: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S600] (INFO) Lines 22-22, sid 1999001: The rule uses the `pcre` option but has no `content` option set. Consider using the content option atleast once to anchor and improve runtime performance.[0m
[34m[S520] (INFO) Lines 22-22, sid 1999001: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[S522] (INFO) Lines 22-22, sid 1999001: The rule sets a xbit but does not explcitly set the expire option. Consider setting the expire option to indicate for how long the xbit remains relevant.[0m
[34m[C000] (WARNING) Lines 22-22, sid 1999001: The rule uses the Suricata threshold option in combination with the setting of flowbits or xbits. Note that the flowbit or xbit will be set on every match regardless of whether the threshold is reached. Consider removing the `threshold` option from the rule to prevent confusion.[0m
[34m[S123] (INFO) Lines 22-22, sid 1999001: The rule escaped special characters using a blackslash (\) in a pcre field. Consider using hex encoding instead.[0m
[34m[S800] (INFO) Lines 23-23, sid 1999002: The rule did not specify the `attack_target` metadata option. Consider specifying the `attack_target` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S011] (INFO) Lines 23-23, sid 1999002: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S020] (INFO) Lines 23-23, sid 1999002: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S520] (INFO) Lines 23-23, sid 1999002: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[S522] (INFO) Lines 23-23, sid 1999002: The rule sets a xbit but does not explcitly set the expire option. Consider setting the expire option to indicate for how long the xbit remains relevant.[0m
[34m[C000] (WARNING) Lines 23-23, sid 1999002: The rule uses the Suricata threshold option in combination with the setting of flowbits or xbits. Note that the flowbit or xbit will be set on every match regardless of whether the threshold is reached. Consider removing the `threshold` option from the rule to prevent confusion.[0m
[34m[S011] (INFO) Lines 32-32, sid 1999010: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 32-32, sid 1999010: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[S520] (INFO) Lines 32-32, sid 1999010: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[S011] (INFO) Lines 33-33, sid 1999011: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 33-33, sid 1999011: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[S520] (INFO) Lines 33-33, sid 1999011: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[S011] (INFO) Lines 34-34, sid 1999012: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 34-34, sid 1999012: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[S520] (INFO) Lines 34-34, sid 1999012: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[S011] (INFO) Lines 37-37, sid 1999020: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S020] (INFO) Lines 37-37, sid 1999020: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S600] (INFO) Lines 37-37, sid 1999020: The rule uses the `pcre` option but has no `content` option set. Consider using the content option atleast once to anchor and improve runtime performance.[0m
[34m[S520] (INFO) Lines 37-37, sid 1999020: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[S123] (INFO) Lines 37-37, sid 1999020: The rule escaped special characters using a blackslash (\) in a pcre field. Consider using hex encoding instead.[0m
[34m[S011] (INFO) Lines 38-38, sid 1999021: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S020] (INFO) Lines 38-38, sid 1999021: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S600] (INFO) Lines 38-38, sid 1999021: The rule uses the `pcre` option but has no `content` option set. Consider using the content option atleast once to anchor and improve runtime performance.[0m
[34m[S520] (INFO) Lines 38-38, sid 1999021: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[S123] (INFO) Lines 38-38, sid 1999021: The rule escaped special characters using a blackslash (\) in a pcre field. Consider using hex encoding instead.[0m
[34m[S011] (INFO) Lines 41-41, sid 1999030: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S020] (INFO) Lines 41-41, sid 1999030: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S600] (INFO) Lines 41-41, sid 1999030: The rule uses the `pcre` option but has no `content` option set. Consider using the content option atleast once to anchor and improve runtime performance.[0m
[34m[S520] (INFO) Lines 41-41, sid 1999030: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[S011] (INFO) Lines 42-42, sid 1999031: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S020] (INFO) Lines 42-42, sid 1999031: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S600] (INFO) Lines 42-42, sid 1999031: The rule uses the `pcre` option but has no `content` option set. Consider using the content option atleast once to anchor and improve runtime performance.[0m
[34m[S520] (INFO) Lines 42-42, sid 1999031: The rule sets xbits with a non-standard name. Consider using `RULESET.description` as name for the xbit.[0m
[34m[C100] (INFO) Lines 45-45, sid 1999040: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[S011] (INFO) Lines 45-45, sid 1999040: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 45-45, sid 1999040: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[S011] (INFO) Lines 46-46, sid 1999041: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 46-46, sid 1999041: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[S011] (INFO) Lines 47-47, sid 1999042: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 47-47, sid 1999042: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[S011] (INFO) Lines 50-50, sid 1999050: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 50-50, sid 1999050: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[C100] (INFO) Lines 51-51, sid 1999051: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[S011] (INFO) Lines 51-51, sid 1999051: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 51-51, sid 1999051: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[C100] (INFO) Lines 52-52, sid 1999052: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[S011] (INFO) Lines 52-52, sid 1999052: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 52-52, sid 1999052: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[C100] (INFO) Lines 53-53, sid 1999053: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[S011] (INFO) Lines 53-53, sid 1999053: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 53-53, sid 1999053: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[C100] (INFO) Lines 54-54, sid 1999054: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[S011] (INFO) Lines 54-54, sid 1999054: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S021] (INFO) Lines 54-54, sid 1999054: The rule has multiple content matches but does not use fast_pattern. Consider assigning fast_pattern to the most unique content match.[0m
[34m[S011] (INFO) Lines 57-57, sid 1999060: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S020] (INFO) Lines 57-57, sid 1999060: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S600] (INFO) Lines 57-57, sid 1999060: The rule uses the `pcre` option but has no `content` option set. Consider using the content option atleast once to anchor and improve runtime performance.[0m
[34m[S121] (INFO) Lines 57-57, sid 1999060: The rule did escape (\x3a\x3b\x20\x22\x27\x7b\x7c\x5c\x2f\x60\x24\x28\x29) in a pcre field. Consider using hex encoding instead.[0m
[34m[S123] (INFO) Lines 57-57, sid 1999060: The rule escaped special characters using a blackslash (\) in a pcre field. Consider using hex encoding instead.[0m
[34m[S011] (INFO) Lines 58-58, sid 1999061: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S121] (INFO) Lines 58-58, sid 1999061: The rule did escape (\x3a\x3b\x20\x22\x27\x7b\x7c\x5c\x2f\x60\x24\x28\x29) in a pcre field. Consider using hex encoding instead.[0m
[34m[S123] (INFO) Lines 58-58, sid 1999061: The rule escaped special characters using a blackslash (\) in a pcre field. Consider using hex encoding instead.[0m
[34m[S404] (INFO) Lines 59-59, sid 1999062: The rule uses a different way of writing CnC (Command & Control) in the msg field. Consider writing CnC instead.[0m
[34m[S011] (INFO) Lines 59-59, sid 1999062: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S020] (INFO) Lines 59-59, sid 1999062: The detection logic does not use the content option, which is can cause significant runtime overhead. Consider adding a content match.[0m
[34m[S600] (INFO) Lines 59-59, sid 1999062: The rule uses the `pcre` option but has no `content` option set. Consider using the content option atleast once to anchor and improve runtime performance.[0m
[34m[S121] (INFO) Lines 59-59, sid 1999062: The rule did escape (\x3a\x3b\x20\x22\x27\x7b\x7c\x5c\x2f\x60\x24\x28\x29) in a pcre field. Consider using hex encoding instead.[0m
[34m[S123] (INFO) Lines 59-59, sid 1999062: The rule escaped special characters using a blackslash (\) in a pcre field. Consider using hex encoding instead.[0m
[34m[S404] (INFO) Lines 60-60, sid 1999063: The rule uses a different way of writing CnC (Command & Control) in the msg field. Consider writing CnC instead.[0m
[34m[S011] (INFO) Lines 60-60, sid 1999063: The rule uses priority option, which overrides operator tuning via classification.conf. Consider removing the option.[0m
[34m[S121] (INFO) Lines 60-60, sid 1999063: The rule did escape (\x3a\x3b\x20\x22\x27\x7b\x7c\x5c\x2f\x60\x24\x28\x29) in a pcre field. Consider using hex encoding instead.[0m
[34m[S123] (INFO) Lines 60-60, sid 1999063: The rule escaped special characters using a blackslash (\) in a pcre field. Consider using hex encoding instead.[0m
[34m[C100] (INFO) Lines 66-66, sid 1: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[C101] (INFO) Lines 66-66, sid 1: The rule does not use set the `created_at` metadata option. Consider adding the `created_at` metadata option to inform users of the recency of this signature.[0m
[34m[S800] (INFO) Lines 66-66, sid 1: The rule did not specify the `attack_target` metadata option. Consider specifying the `attack_target` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S801] (INFO) Lines 66-66, sid 1: The rule did not specify the `signature_severity` metadata option. Consider specifying the `signature_severity` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S802] (INFO) Lines 66-66, sid 1: The rule did not specify the `performance_impact` metadata option. Consider specifying the `performance_impact` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S803] (INFO) Lines 66-66, sid 1: The rule did not specify the `deployment` metadata option. Consider specifying the `deployment` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S400] (INFO) Lines 66-66, sid 1: The rule has a non-standard format for the msg field. Consider changing the msg field to `RULESET CATEGORY Description`.[0m
[34m[S406] (WARNING) Lines 66-66, sid 1: The rule specifies a domain name without escaping the label seperators. Consider escaping the domain names by putting a space before the dot like `foo .bar` to prevent information leaks.[0m
[34m[S000] (INFO) Lines 66-66, sid 1: The rule did not specificy an inbound or outbound direction. Consider constraining the rule to a specific direction such as INBOUND or OUTBOUND traffic.[0m
[34m[S301] (INFO) Lines 66-66, sid 1: Allocation to unallocated SID range, whereas local range should be used. Consider using an sid in one of the following ranges: [(1000000, 1999999)].[0m
[34m[S102] (INFO) Lines 66-66, sid 1: The rule contains unneccessary whitespace before the colon (:) after an option name. Consider removing the unneccessary whitespace.[0m
[34m[S103] (INFO) Lines 66-66, sid 1: The rule contains unneccessary whitespace before the colon (:) after an option name. Consider removing the unneccessary whitespace.[0m
[34m[C100] (INFO) Lines 68-72, sid 1: The rule does not use the `target` Suricata meta option. Consider adding the `target` option to specify which IP address is the target of the attack.[0m
[34m[C101] (INFO) Lines 68-72, sid 1: The rule does not use set the `created_at` metadata option. Consider adding the `created_at` metadata option to inform users of the recency of this signature.[0m
[34m[S800] (INFO) Lines 68-72, sid 1: The rule did not specify the `attack_target` metadata option. Consider specifying the `attack_target` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S801] (INFO) Lines 68-72, sid 1: The rule did not specify the `signature_severity` metadata option. Consider specifying the `signature_severity` metadata option to help analysts interpret alerts raised by this rule.[0m
[34m[S802] (INFO) Lines 68-72, sid 1: The rule did not specify the `performance_impact` metadata option. Consider specifying the `performance_impact` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S803] (INFO) Lines 68-72, sid 1: The rule did not specify the `deployment` metadata option. Consider specifying the `deployment` metadata option to help SOCs determine when to enable this rule.[0m
[34m[S400] (INFO) Lines 68-72, sid 1: The rule has a non-standard format for the msg field. Consider changing the msg field to `RULESET CATEGORY Description`.[0m
[34m[S406] (WARNING) Lines 68-72, sid 1: The rule specifies a domain name without escaping the label seperators. Consider escaping the domain names by putting a space before the dot like `foo .bar` to prevent information leaks.[0m
[34m[S000] (INFO) Lines 68-72, sid 1: The rule did not specificy an inbound or outbound direction. Consider constraining the rule to a specific direction such as INBOUND or OUTBOUND traffic.[0m
[34m[S301] (INFO) Lines 68-72, sid 1: Allocation to unallocated SID range, whereas local range should be used. Consider using an sid in one of the following ranges: [(1000000, 1999999)].[0m
[34m[S100] (INFO) Lines 68-72, sid 1: The rule contains unneccessary whitespace after opening the rule body with. Consider removing the unneccessary whitespace.[0m
[34m[S101] (INFO) Lines 68-72, sid 1: The rule contains unneccessary whitespace before closing the rule body with. Consider removing the unneccessary whitespace.[0m
[34m[1mTotal issues found: 143[0m
[34m[1mRules with Issues found: 27[0m
